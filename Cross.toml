# refer to: https://github.com/cross-rs/cross/blob/main/docs/config_file.md
[build]
default-target = "x86_64-unknown-linux-gnu"   # use this target if none is explicitly provided
pre-build = [                                  # additional commands to run prior to building the package
    "dpkg --add-architecture $CROSS_DEB_ARCH", 
    "apt-get update && apt-get -y install pkg-config libssl-dev:$CROSS_DEB_ARCH cmake libclang-dev",
]

[target.x86_64-unknown-linux-gnu]
linker = "x86_64-linux-gnu-gcc"
image = "ghcr.io/cross-rs/x86_64-unknown-linux-gnu@sha256:25e3a1b7d4a57ff9326d69a302005e909014e48f7995b70a2feaa71faad469c5"
# disable target-feature=+crt-static since it causes failures in domain resolution
# https://github.com/rust-lang/rust/issues/100711
# https://stackoverflow.com/questions/73402445/rust-x86-64-unknown-linux-gnu-using-target-feature-crt-static-exits-with-seg
# rustflags = ["-C", "target-feature=+crt-static"]

[target.aarch64-unknown-linux-gnu]
linker = "aarch64-linux-gnu-gcc"
image = "ghcr.io/cross-rs/aarch64-unknown-linux-gnu@sha256:c1900e1ae2f304085176ed10087c3b5927887dbdaf1e4fc14c3a319fcc60c109"
# rustflags = ["-C", "target-feature=+crt-static"]